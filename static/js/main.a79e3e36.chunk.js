(this["webpackJsonpdreamhead-test"]=this["webpackJsonpdreamhead-test"]||[]).push([[0],{41:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(17),i=a.n(s),r=(a(41),a(3)),o=a(5),l=a(31),d=a.n(l),u=null!==localStorage.getItem("token")?localStorage.getItem("token"):"",j=a(4),m="/",b="/login",h="/favorites",p=["Paris","Cologne","Brussels","Amsterdam","Hamburg","Dusseldorf"],O="AUTH",g="NO_AUTH",_="UNAUTHORIZED",f="/hotels",v="/login",x="/logout",y="Popular",N="Price: low to high",C="Price: high to low",w="Top rated first",S=a(16),k=a(9),P=a(0);var F=function(e){return Object(P.jsx)("li",{className:"header__nav-item user",children:Object(P.jsxs)(k.a,{className:"header__nav-link header__nav-link--profile",to:b,children:[Object(P.jsx)("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),Object(P.jsx)("span",{className:"header__login",children:"Sign in"})]})})},L="places/changeCity",T="places/sortBy",E="places/loadPlaces",I="places/loadNearbyPlaces",M="places/removeNearbyPlaces",A="places/isFavorite",B="comments/loadComments",D="comments/removeComments",R="user/changeAuthorizationStatus",U="user/changeLogin",z="user/logout",H="comment/changeLoadingCommentProcessStatus",q="comment/showErrorCommentFormMessage",J="comment/changeCommentSendedSuccessfulyStatus",V="places/resetFavorites",W="places/redirectToRoute",K=Object(r.b)(H,(function(e){return{payload:e}})),Z=Object(r.b)(J,(function(e){return{payload:e}})),G=Object(r.b)(q,(function(e,t){return{payload:{isShowErrorMessage:e,errorMessageText:t}}})),Q=Object(r.b)(L,(function(e){return{payload:e}})),X=Object(r.b)(T,(function(e){return{payload:e}})),Y=Object(r.b)(E,(function(e){return{payload:e}})),$=Object(r.b)(I,(function(e){return{payload:e}})),ee=Object(r.b)(M),te=Object(r.b)(B,(function(e){return{payload:e}})),ae=Object(r.b)(D),ne=Object(r.b)(R,(function(e){return{payload:e}})),ce=Object(r.b)(U,(function(e){return{payload:e}})),se=Object(r.b)(A,(function(e,t){return{payload:{id:e,newPlace:t}}})),ie=Object(r.b)(z),re=Object(r.b)(V,(function(e){return{payload:e}})),oe=Object(r.b)(W,(function(e){return{payload:e}})),le=a(13),de=a(12),ue={authorizationStatus:g,login:_},je=Object(r.c)(ue,(function(e){e.addCase(ne,(function(e,t){e.authorizationStatus=t.payload})).addCase(ce,(function(e,t){e.login=t.payload})).addCase(ie,(function(e){e.authorizationStatus=g,e.login=_}))})),me=a(36),be=a(33),he=a(34),pe=a(35),Oe=a.n(pe),ge=function(){function e(){Object(be.a)(this,e)}return Object(he.a)(e,null,[{key:"adaptToClient",value:function(e){var t=Object.assign({},e,{host:Object.assign({},e.host,{avatarUrl:e.host.avatar_url,isPro:e.host.is_pro}),isFavorite:e.is_favorite,isPremium:e.is_premium,maxAdults:e.max_adults,previewImage:e.preview_image});return delete t.host.avatar_url,delete t.host.is_pro,delete t.is_favorite,delete t.is_premium,delete t.max_adults,delete t.preview_image,t}},{key:"adaptPlacesToClient",value:function(e){var t=this;return e.map((function(e){return t.adaptToClient(e)}))}},{key:"adaptCommentToClient",value:function(e){var t=Object.assign({},e,{comment:e.comment,date:e.date,id:e.id,rating:e.rating,user:Object.assign({},e.user,{avatarUrl:e.user.avatar_url,isPro:e.user.is_pro,id:e.user.id,name:e.user.name})});return delete t.user.avatar_url,delete t.user.is_pro,t}},{key:"getFavoritePlacesSeparatedByCity",value:function(e){var t=new Map;return e.forEach((function(e){e.isFavorite&&(t.has(e.city.name)||t.set(e.city.name,[]),t.get(e.city.name).push(e))})),t}},{key:"getFilteredPlaces",value:function(e,t){return t.filter((function(t){return t.city.name===e}))}},{key:"generateIdKeys",value:function(e){return new Array(e).fill("").map((function(){return Oe()(10)}))}},{key:"getWidthByRating",value:function(e){return 100*Math.round(e)/5}},{key:"getUpdatedPlaces",value:function(e,t,a){var n=this.adaptToClient(a),c=Object(me.a)(t),s=c.findIndex((function(t){return t.id===e}));return c[s].isFavorite=n.isFavorite,c}},{key:"getNearbyPlacesFromCommonPlaces",value:function(e,t){var a=[];return e.forEach((function(e){var n=t.findIndex((function(t){return t.id===e.id}));a.push(t[n])})),a}},{key:"resetFavoriteStates",value:function(e){return e.map((function(e){return e=Object(S.a)(Object(S.a)({},e),{},{isFavorite:!1})}))}},{key:"getIsTokenExist",value:function(e){null!==localStorage.getItem("token")&&(e(ce(localStorage.getItem("login"))),e(ne(O)))}}]),e}();ge.formatDate=function(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short"})},ge.getSortedPlaces=function(e,t){var a=t.slice();switch(e){case y:return a;case N:return t.sort((function(e,t){return e.price-t.price}));case C:return function(e){return e.sort((function(e,t){return t.price-e.price}))}(t);case w:return function(e){return e.sort((function(e,t){return t.rating-e.rating}))}(t);default:return a}};var _e,fe=ge,ve={places:[],sortBy:y,isDataLoaded:!1,activeCityName:"Paris",isNearbyPlacesLoaded:!1,nearbyPlaces:[]},xe=Object(r.c)(ve,(function(e){e.addCase(Q,(function(e,t){e.activeCityName=t.payload})).addCase(X,(function(e,t){e.sortBy=t.payload})).addCase(Y,(function(e,t){e.places=t.payload,e.isDataLoaded=!0})).addCase($,(function(e,t){e.nearbyPlaces=t.payload,e.isNearbyPlacesLoaded=!0})).addCase(ee,(function(e){e.nearbyPlaces=[],e.isNearbyPlacesLoaded=!1})).addCase(se,(function(e,t){e.places=fe.getUpdatedPlaces(t.payload.id,e.places,t.payload.newPlace)})).addCase(re,(function(e,t){e.places=fe.resetFavoriteStates(t.payload)}))})),ye=Object(r.c)({comments:[],isCommentsLoaded:!1},(function(e){e.addCase(te,(function(e,t){e.comments=t.payload,e.isCommentsLoaded=!0})).addCase(ae,(function(e){e.comments=[],e.isCommentsLoaded=!1}))})),Ne=Object(r.c)({isCommentSending:!1,isCommentFormSendedSuccessfully:null,isShowCommentErrorMessage:!1,commentErrorMessage:null},(function(e){e.addCase(K,(function(e,t){e.isCommentSending=t.payload})).addCase(Z,(function(e,t){e.isCommentFormSendedSuccessfully=t.payload})).addCase(G,(function(e,t){e.isShowCommentErrorMessage=t.payload.isShowErrorMessage,e.commentErrorMessage=t.payload.errorMessageText}))})),Ce="PLACES",we="COMMENTS",Se="USER",ke="COMMENT",Pe=Object(de.b)((_e={},Object(le.a)(_e,Se,je),Object(le.a)(_e,Ce,xe),Object(le.a)(_e,we,ye),Object(le.a)(_e,ke,Ne),_e)),Fe=function(e){return e[Ce].places},Le=function(e){return e[Ce].isDataLoaded},Te=function(e){return e[Ce].activeCityName};var Ee=function(e){var t=e.login,a=Object(o.c)(Fe),c=Object(o.b)();return Object(P.jsxs)(n.Fragment,{children:[Object(P.jsx)("li",{className:"header__nav-item user",children:Object(P.jsxs)(k.a,{className:"header__nav-link header__nav-link--profile",to:h,children:[Object(P.jsx)("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),Object(P.jsx)("span",{className:"header__user-name user__name",children:t})]})}),Object(P.jsx)("li",{className:"header__nav-item",children:Object(P.jsx)(k.a,{className:"header__nav-link",to:m,onClick:function(){c((function(e,t,a){localStorage.removeItem("token"),localStorage.removeItem("login"),a.delete(x).then((function(){e(ie())}))})),c(re(a))},children:Object(P.jsx)("span",{className:"header__signout",children:"Sign out"})})})]})},Ie=function(e){return e[Se].authorizationStatus},Me=function(e){return e[Se].login};var Ae=function(e){var t=e.children,a=e.className,n=Object(o.c)(Me),c=Object(o.c)(Ie);return Object(P.jsxs)("div",{className:a,children:[Object(P.jsx)("header",{className:"header",children:Object(P.jsx)("div",{className:"container",children:Object(P.jsxs)("div",{className:"header__wrapper",children:[Object(P.jsx)("div",{className:"header__left",children:Object(P.jsx)(k.a,{className:"header__logo-link header__logo-link--active",to:"/",children:Object(P.jsx)("img",{className:"header__logo",src:"img/logo.svg",alt:"6 cities logo",width:"81",height:"41"})})}),Object(P.jsx)("nav",{className:"header__nav",children:Object(P.jsx)("ul",{className:"header__nav-list",children:c===O?Object(P.jsx)(Ee,{login:n}):Object(P.jsx)(F,{})})})]})})}),t]})},Be=function(e,t){return function(a){return Object(P.jsx)(Ae,{className:t,children:Object(P.jsx)(e,Object(S.a)({},a))})}};Be.displayName="withLayout";var De=Be;var Re=function(e){var t=Object(o.c)(Te),a=Object(o.b)(),n=function(e){e.preventDefault(),a(Q(e.currentTarget.dataset.city)),a(X(y))};return Object(P.jsx)("div",{className:"tabs",children:Object(P.jsx)("section",{className:"locations container",children:Object(P.jsx)("ul",{className:"locations__list tabs__list",children:p.map((function(e){return Object(P.jsx)("li",{className:"locations__item",children:Object(P.jsx)(k.a,{"data-city":e,className:"locations__item-link tabs__item ".concat(e===t&&"tabs__item--active"),to:"#",onClick:n,children:Object(P.jsx)("span",{children:e})})},e)}))})})})};var Ue=function(e){var t=e.activeCityName;return Object(P.jsx)("div",{className:"cities",children:Object(P.jsxs)("div",{className:"cities__places-container cities__places-container--empty container",children:[Object(P.jsx)("section",{className:"cities__no-places",children:Object(P.jsxs)("div",{className:"cities__status-wrapper tabs__content",children:[Object(P.jsx)("b",{className:"cities__status",children:"No places to stay available"}),Object(P.jsxs)("p",{className:"cities__status-description",children:["We could not find any property available at the moment in ",t]})]})}),Object(P.jsx)("div",{className:"cities__right-section"})]})})};var ze=De((function(){var e=Object(o.c)(Te),t=Object(o.c)(Fe),a=fe.getFilteredPlaces(e,t);return Object(P.jsxs)("main",{className:"page__main page__main--index",children:[Object(P.jsx)("h1",{className:"visually-hidden",children:"Cities"}),Object(P.jsx)(Re,{}),0===a.length?Object(P.jsx)(Ue,{activeCityName:e}):Object(P.jsx)("div",{className:"cities",children:Object(P.jsx)("div",{className:"cities__places-container container",children:Object(P.jsxs)("section",{className:"cities__places places",children:[Object(P.jsx)("h2",{className:"visually-hidden",children:"Places"}),Object(P.jsxs)("b",{className:"places__found",children:[a.length," places to stay in ",e]})]})})})]})}));var He=function(){var e=Object(n.useRef)(),t=Object(n.useRef)(),a=Object(o.b)();return Object(P.jsxs)(n.Fragment,{children:[Object(P.jsx)("div",{style:{display:"none"},children:Object(P.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",children:[Object(P.jsx)("symbol",{id:"icon-arrow-select",viewBox:"0 0 7 4",children:Object(P.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 0l3.5 2.813L7 0v1.084L3.5 4 0 1.084V0z"})}),Object(P.jsx)("symbol",{id:"icon-bookmark",viewBox:"0 0 17 18",children:Object(P.jsx)("path",{d:"M3.993 2.185l.017-.092V2c0-.554.449-1 .99-1h10c.522 0 .957.41.997.923l-2.736 14.59-4.814-2.407-.39-.195-.408.153L1.31 16.44 3.993 2.185z"})}),Object(P.jsx)("symbol",{id:"icon-star",viewBox:"0 0 13 12",children:Object(P.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.5 9.644L10.517 12 9.451 7.56 13 4.573l-4.674-.386L6.5 0 4.673 4.187 0 4.573 3.549 7.56 2.483 12 6.5 9.644z"})})]})}),Object(P.jsxs)("div",{className:"page page--gray page--login",children:[Object(P.jsx)("header",{className:"header",children:Object(P.jsx)("div",{className:"container",children:Object(P.jsxs)("div",{className:"header__wrapper",children:[Object(P.jsx)("div",{className:"header__left",children:Object(P.jsx)(k.a,{className:"header__logo-link",to:"/",children:Object(P.jsx)("img",{className:"header__logo",src:"img/logo.svg",alt:"6 cities logo",width:81,height:41})})}),Object(P.jsx)("nav",{className:"header__nav",children:Object(P.jsx)("ul",{className:"header__nav-list"})})]})})}),Object(P.jsx)("main",{className:"page__main page__main--login",children:Object(P.jsxs)("div",{className:"page__login-container container",children:[Object(P.jsxs)("section",{className:"login",children:[Object(P.jsx)("h1",{className:"login__title",children:"Sign in"}),Object(P.jsxs)("form",{className:"login__form form",action:"",method:"post",onSubmit:function(n){n.preventDefault(),a(function(e){var t=e.login,a=e.password;return function(e,n,c){localStorage.removeItem("token"),localStorage.removeItem("login"),c.post(v,{email:t,password:a}).then((function(t){localStorage.setItem("token",t.data.token),localStorage.setItem("login",t.data.email),e(ce(t.data.email)),e(ne(O)),e(oe(m))})).catch((function(e){}))}}({login:e.current.value,password:t.current.value}))},children:[Object(P.jsxs)("div",{className:"login__input-wrapper form__input-wrapper",children:[Object(P.jsx)("label",{className:"visually-hidden",children:"E-mail"}),Object(P.jsx)("input",{ref:e,className:"login__input form__input",type:"email",name:"email",placeholder:"Email",required:!0})]}),Object(P.jsxs)("div",{className:"login__input-wrapper form__input-wrapper",children:[Object(P.jsx)("label",{className:"visually-hidden",children:"Password"}),Object(P.jsx)("input",{ref:t,className:"login__input form__input",type:"password",name:"password",placeholder:"Password",required:!0})]}),Object(P.jsx)("button",{className:"login__submit form__submit button",type:"submit",children:"Sign in"})]})]}),Object(P.jsx)("section",{className:"locations locations--login locations--current",children:Object(P.jsx)("div",{className:"locations__item",children:Object(P.jsx)(k.a,{className:"locations__item-link",to:"/",children:Object(P.jsx)("span",{children:"Amsterdam"})})})})]})})]})]})};var qe=De((function(){return Object(P.jsxs)("div",{style:{margin:"auto",width:"200px"},children:[Object(P.jsx)("h1",{style:{textAlign:"center"},children:"404"}),Object(P.jsx)("h2",{children:"Page Not Found"})]})}));var Je=function(){return Object(P.jsx)("p",{children:"Loading..."})},Ve=a(6),We=Object(Ve.a)();var Ke=function(){return Object(o.c)(Le)?Object(P.jsx)(j.b,{history:We,children:Object(P.jsxs)(j.c,{children:[Object(P.jsx)(j.a,{exact:!0,path:m,children:Object(P.jsx)(ze,{className:"page page--gray page--index"})}),Object(P.jsx)(j.a,{exact:!0,path:b,children:Object(P.jsx)(He,{})}),Object(P.jsx)(j.a,{children:Object(P.jsx)(qe,{})})]})}):Object(P.jsx)(Je,{})},Ze=function(e){return function(e){return function(t){return t.type===W&&We.push(t.payload),e(t)}}},Ge=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,68)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),s(e),i(e)}))},Qe=function(){var e=d.a.create({baseURL:"https://7.react.pages.academy/six-cities",timeout:5e3,headers:{"x-token":u}});return e.interceptors.response.use((function(e){return e}),(function(){})),e}(),Xe=Object(r.a)({reducer:Pe,middleware:function(e){return e({thunk:{extraArgument:Qe}}).concat(Ze)}});fe.getIsTokenExist(Xe.dispatch),Xe.dispatch((function(e,t,a){return a.get(f).then((function(t){var a=t.data,n=fe.adaptPlacesToClient(a);e(Y(n))})).catch((function(e){}))})),i.a.render(Object(P.jsx)(c.a.StrictMode,{children:Object(P.jsx)(o.a,{store:Xe,children:Object(P.jsx)(Ke,{})})}),document.getElementById("root")),Ge()}},[[67,1,2]]]);
//# sourceMappingURL=main.a79e3e36.chunk.js.map